<!DOCTYPE html>
<html lang="ru">
  <head>
    <script src="https://api.bitrix24.com/api/v1/" async></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Рейсы</title>
    <link rel="stylesheet" href="../assets/hauls.css" />
  </head>
  <body>
    <div class="app">
      <header>
        <h1>Рейсы сделки <span id="deal-label"></span></h1>
        <div class="controls">
          <label>
            ID сделки
            <input type="number" id="deal-id-input" />
          </label>
          <button id="load-hauls">Загрузить</button>
        </div>
      </header>

      <section class="form-section">
        <h2>Новый рейс</h2>
        <form id="haul-form">
          <div class="grid">
            <label>Водитель
              <select name="responsible_id" id="driver-select"></select>
            </label>
            <label>Самосвал
              <select name="truck_id" id="truck-select"></select>
            </label>
            <label>Материал
              <select name="material_id" id="material-select"></select>
            </label>
            <label>Объём (м³)
              <input type="number" step="0.01" name="load_volume" />
            </label>
          </div>

          <fieldset>
            <legend>Загрузка</legend>
            <label>Адрес
              <input type="text" name="load_address_text" required />
            </label>
            <label>Ссылка на карту
              <input type="url" name="load_address_url" />
            </label>
            <div class="grid">
              <label>Компания от кого (ID)
                <input type="number" name="load_from_company_id" />
              </label>
              <label>Компания кому (ID)
                <input type="number" name="load_to_company_id" />
              </label>
            </div>
          </fieldset>

          <fieldset>
            <legend>Выгрузка</legend>
            <label>Адрес
              <input type="text" name="unload_address_text" required />
            </label>
            <label>Ссылка на карту
              <input type="url" name="unload_address_url" />
            </label>
            <div class="grid">
              <label>Компания от кого (ID)
                <input type="number" name="unload_from_company_id" />
              </label>
              <label>Компания кому (ID)
                <input type="number" name="unload_to_company_id" />
              </label>
            </div>
            <div class="grid">
              <label>Контактное имя
                <input type="text" name="unload_contact_name" />
              </label>
              <label>Контактный телефон
                <input type="tel" name="unload_contact_phone" />
              </label>
            </div>
          </fieldset>

          <button type="submit">Сохранить рейс</button>
        </form>
      </section>

      <section class="list-section">
        <h2>Список рейсов</h2>
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Водитель</th>
              <th>Авто</th>
              <th>Материал</th>
              <th>Объём</th>
              <th>Загрузка</th>
              <th>Выгрузка</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="haul-table-body"></tbody>
        </table>
      </section>
    </div>
    <script src="../assets/hauls.js" type="module"></script>
      <script>window.B24_HAULS_WIDGET = true;</script>
  </body>
</html>
